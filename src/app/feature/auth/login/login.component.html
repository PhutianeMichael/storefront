<div class="login-page">
  <h1 class="login-title">Welcome back</h1>
  <p class="login-subtitle">Sign in to continue shopping</p>

  <form [formGroup]="form" (ngSubmit)="onSubmit(loading())" class="login-form" autocomplete="on">
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Email</mat-label>
      <input matInput type="email" formControlName="email" placeholder="you@example.com"/>
      <mat-icon matSuffix>mail</mat-icon>
      @if (email.touched && email.hasError('required')) {
        <mat-error>Email is required</mat-error>
      }
      @if (email.touched && email.hasError('email')) {
        <mat-error>Enter a valid email</mat-error>
      }

    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Password</mat-label>
      <input
        matInput
        [type]="hidePassword ? 'password' : 'text'"
        formControlName="password"
        placeholder="••••••••"
      />
      <button type="button" mat-icon-button matSuffix (click)="hidePassword = !hidePassword"
              [attr.aria-label]="'Toggle password visibility'">
        <mat-icon>{{ hidePassword ? 'visibility' : 'visibility_off' }}</mat-icon>
      </button>
      @if (password.touched && password.hasError('required')) {
        <mat-error>Password is required</mat-error>
      }

      @if (password.touched && password.hasError('minlength')) {
        <mat-error>Minimum 6 characters</mat-error>
      }
    </mat-form-field>

    <div class="form-row">
      <mat-checkbox formControlName="rememberMe">Remember me</mat-checkbox>
      <a class="link" href="#" (click)="$event.preventDefault()">Forgot password?</a>
    </div>

    <button
      mat-raised-button
      color="primary"
      class="submit-btn"
      type="submit"
      [disabled]="form.invalid || loading()"
    >
      @if (!loading()) {
        <ng-container>
          <mat-icon class="left btn-icon">login</mat-icon>
          <span class="btn-label">Sign in</span>
        </ng-container>
      } @else {
        <span>Signing in…</span>
      }
    </button>

    @if (errorMessage()) {
      <div class="error">{{ errorMessage() }}</div>
    }

    <p class="signup-hint">
      New here?
      <a class="link" routerLink="/signup">Create an account</a>
    </p>
  </form>
</div>
